<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PptxGenJS Table Builder</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="container">
      <nav>
        <ul>
          <li><strong>Advanced Table Builder</strong></li>
        </ul>
        <ul>
          <li><a href="index.html">Back to gallery</a></li>
        </ul>
      </nav>

      <p>
        Upload CSV or JSON data, define column order and widths, then export a
        PowerPoint table with custom PptxGenJS options.
      </p>

      <article>
        <h2>1) Upload data</h2>
        <label for="data-file">CSV or JSON file</label>
        <input id="data-file" type="file" accept=".csv,.json,application/json,text/csv" />
        <small>JSON can be an array of objects, an object with a <code>rows</code> array, or an array-of-arrays.</small>
      </article>

      <article>
        <h2>2) Configure columns</h2>
        <p>Reorder with drag-and-drop. Set width (inches) and text alignment per column.</p>
        <ul id="column-config" class="column-list"></ul>
      </article>

      <article>
        <h2>3) Table options</h2>
        <div class="grid">
          <label>
            Slide title
            <input id="slide-title" value="Uploaded Data Table" />
          </label>
          <label>
            File name
            <input id="file-name" value="pptxgenjs-uploaded-table.pptx" />
          </label>
          <label>
            Header fill color (hex)
            <input id="header-fill" value="1D4ED8" />
          </label>
          <label>
            Header text color (hex)
            <input id="header-text" value="FFFFFF" />
          </label>
          <label>
            Body fill color (hex)
            <input id="body-fill" value="F8FAFC" />
          </label>
          <label>
            Border color (hex)
            <input id="border-color" value="CBD5E1" />
          </label>
          <label>
            Font size
            <input id="font-size" type="number" min="8" max="28" step="1" value="12" />
          </label>
          <label>
            Row height (in)
            <input id="row-height" type="number" min="0.2" max="2" step="0.05" value="0.45" />
          </label>
          <label>
            Margin (in)
            <input id="cell-margin" type="number" min="0" max="0.3" step="0.01" value="0.04" />
          </label>
          <label>
            Vertical align
            <select id="valign">
              <option value="top">top</option>
              <option value="mid" selected>mid</option>
              <option value="bot">bot</option>
            </select>
          </label>
          <label>
            Auto fit
            <select id="autofit">
              <option value="false" selected>false</option>
              <option value="true">true</option>
            </select>
          </label>
          <label>
            Include slide notes
            <select id="include-notes">
              <option value="false" selected>false</option>
              <option value="true">true</option>
            </select>
          </label>
        </div>
      </article>

      <button id="generate-table" disabled>Generate table presentation</button>
      <small id="table-status" role="status" aria-live="polite"></small>

      <article>
        <h2>Data preview</h2>
        <figure class="overflow-auto">
          <table>
            <thead id="preview-head"></thead>
            <tbody id="preview-body"></tbody>
          </table>
        </figure>
      </article>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <script src="table-builder.js"></script>
  </body>
</html>
